<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>업무일지 템플릿 생성기</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.2em;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .preview-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #e9ecef;
        }
        
        .preview-section h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .template-preview {
            background: white;
            border-radius: 10px;
            padding: 15px;
            overflow-x: auto;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9em;
        }
        
        th, td {
            border: 1px solid #dee2e6;
            padding: 8px;
            text-align: left;
        }
        
        th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-weight: 600;
        }
        
        td {
            background: #f8f9fa;
        }
        
        .download-section {
            text-align: center;
            margin-top: 30px;
        }
        
        .download-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
            opacity: 0.7;
            position: relative;
            overflow: hidden;
        }
        
        .download-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .download-btn:not(:disabled):hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
        }
        
        .status-message {
            margin-top: 15px;
            color: #6c757d;
            font-size: 0.9em;
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .feature-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
        }
        
        .feature-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
        }
        
        .feature-title {
            color: #2c3e50;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .feature-desc {
            color: #6c757d;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>📊 업무일지 템플릿 생성기</h1>
        
        <div class="preview-section">
            <h3>📋 템플릿 미리보기</h3>
            <div class="template-preview">
                <table>
                    <thead>
                        <tr>
                            <th>날짜</th>
                            <th>시간</th>
                            <th>업무구분</th>
                            <th>프로젝트명</th>
                            <th>세부업무</th>
                            <th>진행상황</th>
                            <th>완료율(%)</th>
                            <th>협업대상</th>
                            <th>비고</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>2025-07-07</td>
                            <td>09:00-12:00</td>
                            <td>개발</td>
                            <td>AI 뷰티 디바이스</td>
                            <td>피부 분석 알고리즘 개발</td>
                            <td>진행중</td>
                            <td>65</td>
                            <td>개발팀</td>
                            <td>데이터 수집 완료</td>
                        </tr>
                        <tr>
                            <td>2025-07-07</td>
                            <td>14:00-17:00</td>
                            <td>설계</td>
                            <td>스킨케어 디바이스</td>
                            <td>CAD 모델링</td>
                            <td>완료</td>
                            <td>100</td>
                            <td>설계팀</td>
                            <td>3D 프린팅 준비</td>
                        </tr>
                        <tr>
                            <td>2025-07-08</td>
                            <td>10:00-11:30</td>
                            <td>회의</td>
                            <td>글로벌 진출</td>
                            <td>해외 파트너사 미팅</td>
                            <td>진행중</td>
                            <td>50</td>
                            <td>영업팀</td>
                            <td>후속 미팅 예정</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="features">
            <div class="feature-card">
                <div class="feature-icon">🎯</div>
                <div class="feature-title">프로젝트 관리</div>
                <div class="feature-desc">뷰티 디바이스 개발부터 AI 알고리즘까지 모든 프로젝트를 체계적으로 관리</div>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">📈</div>
                <div class="feature-title">진행률 추적</div>
                <div class="feature-desc">각 업무의 완료율을 시각적으로 추적하여 프로젝트 현황을 한눈에 파악</div>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">👥</div>
                <div class="feature-title">협업 관리</div>
                <div class="feature-desc">팀원 및 파트너사와의 협업 현황을 체계적으로 기록하고 관리</div>
            </div>
        </div>
        
        <div class="download-section">
            <button class="download-btn" id="showDataBtn" onclick="showCSVData()">
                📋 CSV 데이터 보기
            </button>
            <p class="status-message" id="statusMsg">
                ✅ 준비 완료! 버튼을 클릭하여 CSV 데이터를 확인하세요
            </p>
            
            <!-- CSV 데이터 표시 영역 -->
            <div id="csvDataContainer" style="display: none; margin-top: 30px;">
                <div style="background: #f8f9fa; border-radius: 15px; padding: 20px; margin-bottom: 20px;">
                    <h3 style="color: #495057; margin-bottom: 15px;">📋 업무일지 CSV</h3>
                    <textarea id="workLogCSV" readonly style="width: 100%; height: 200px; font-family: monospace; font-size: 12px; border: 1px solid #ddd; border-radius: 5px; padding: 10px;"></textarea>
                    <button onclick="copyToClipboard('workLogCSV')" style="margin-top: 10px; padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">📋 복사</button>
                </div>
                
                <div style="background: #f8f9fa; border-radius: 15px; padding: 20px; margin-bottom: 20px;">
                    <h3 style="color: #495057; margin-bottom: 15px;">📈 프로젝트 현황 CSV</h3>
                    <textarea id="projectCSV" readonly style="width: 100%; height: 150px; font-family: monospace; font-size: 12px; border: 1px solid #ddd; border-radius: 5px; padding: 10px;"></textarea>
                    <button onclick="copyToClipboard('projectCSV')" style="margin-top: 10px; padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">📋 복사</button>
                </div>
                
                <div style="background: #f8f9fa; border-radius: 15px; padding: 20px; margin-bottom: 20px;">
                    <h3 style="color: #495057; margin-bottom: 15px;">🎯 월별 목표 CSV</h3>
                    <textarea id="monthlyCSV" readonly style="width: 100%; height: 150px; font-family: monospace; font-size: 12px; border: 1px solid #ddd; border-radius: 5px; padding: 10px;"></textarea>
                    <button onclick="copyToClipboard('monthlyCSV')" style="margin-top: 10px; padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">📋 복사</button>
                </div>
                
                <div style="background: #f8f9fa; border-radius: 15px; padding: 20px; margin-bottom: 20px;">
                    <h3 style="color: #495057; margin-bottom: 15px;">🏆 자격증 관리 CSV</h3>
                    <textarea id="certCSV" readonly style="width: 100%; height: 150px; font-family: monospace; font-size: 12px; border: 1px solid #ddd; border-radius: 5px; padding: 10px;"></textarea>
                    <button onclick="copyToClipboard('certCSV')" style="margin-top: 10px; padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">📋 복사</button>
                </div>
                
                <div style="background: #e7f3ff; border-radius: 10px; padding: 15px; margin-top: 20px;">
                    <h4 style="color: #0066cc; margin-bottom: 10px;">💡 사용 방법</h4>
                    <ul style="color: #333; font-size: 14px; line-height: 1.6;">
                        <li><strong>노션</strong>: 테이블 생성 → CSV 데이터 붙여넣기</li>
                        <li><strong>Excel</strong>: 새 파일 → A1 셀에 붙여넣기 → 데이터 → 텍스트 나누기</li>
                        <li><strong>Google Sheets</strong>: 새 시트 → 붙여넣기 (자동으로 열 분리됨)</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- SheetJS 라이브러리 로드 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <script>
        // 전역 변수
        let libraryLoaded = false;
        
        // DOM 요소
        const downloadBtn = document.getElementById('downloadBtn');
        const statusMsg = document.getElementById('statusMsg');
        
        // 라이브러리 로딩 확인
        function checkLibraryStatus() {
            console.log('라이브러리 상태 확인 중...');
            
            if (typeof XLSX !== 'undefined' && XLSX.utils && XLSX.writeFile) {
                libraryLoaded = true;
                console.log('✅ SheetJS 라이브러리 로드 성공!');
                
                // UI 업데이트
                downloadBtn.disabled = false;
                downloadBtn.style.opacity = '1';
                statusMsg.textContent = '✅ 준비 완료! 버튼을 클릭하여 다운로드하세요';
                statusMsg.style.color = '#28a745';
                
                return true;
            } else {
                console.log('❌ 라이브러리 아직 로드되지 않음');
                return false;
            }
        }
        
        // 페이지 로드 후 바로 활성화
        window.addEventListener('load', function() {
            console.log('페이지 로드 완료 - 텍스트 표시 모드');
            
            // 바로 버튼 활성화 (라이브러리 불필요)
            const showBtn = document.getElementById('showDataBtn');
            const statusMsg = document.getElementById('statusMsg');
            
            setTimeout(() => {
                console.log('✅ 준비 완료!');
            }, 100);
        });
        
        // CSV 데이터 표시 함수
        function showCSVData() {
            console.log('CSV 데이터 생성 중...');
            
            try {
                // CSV 생성 함수
                function arrayToCSV(data) {
                    return data.map(row => 
                        row.map(cell => {
                            if (typeof cell === 'string' && (cell.includes(',') || cell.includes('"') || cell.includes('\n'))) {
                                return '"' + cell.replace(/"/g, '""') + '"';
                            }
                            return cell;
                        }).join(',')
                    ).join('\n');
                }
                
                // 업무일지 데이터
                const workLogData = [
                    ["날짜", "시간", "업무구분", "프로젝트명", "세부업무", "진행상황", "완료율(%)", "협업대상", "비고"],
                    ["2025-07-07", "09:00-12:00", "개발", "AI 뷰티 디바이스", "피부 분석 알고리즘 개발", "진행중", 65, "개발팀", "데이터 수집 완료"],
                    ["2025-07-07", "14:00-17:00", "설계", "스킨케어 디바이스", "CAD 모델링", "완료", 100, "설계팀", "3D 프린팅 준비"],
                    ["2025-07-08", "10:00-11:30", "회의", "글로벌 진출", "해외 파트너사 미팅", "진행중", 50, "영업팀", "후속 미팅 예정"],
                    ["2025-07-08", "15:00-18:00", "연구", "정처기 자격증", "필기 시험 준비", "진행중", 75, "개인학습", "알고리즘 문제 풀이"],
                    ["2025-07-09", "09:00-10:00", "관리", "깃허브 프로젝트", "minaverse-dev 업데이트", "계획", 0, "개발팀", "포트폴리오 정리"]
                ];
                
                // 빈 행 15개 추가
                for(let i = 0; i < 15; i++) {
                    workLogData.push(["", "", "", "", "", "", "", "", ""]);
                }
                
                // 프로젝트 현황 데이터
                const projectData = [
                    ["프로젝트명", "시작일", "목표완료일", "현재진행률", "담당자", "상태", "비고"],
                    ["AI 뷰티 디바이스", "2025-06-01", "2025-09-30", "65%", "개발팀", "진행중", "알고리즘 개발 단계"],
                    ["스킨케어 디바이스", "2025-07-01", "2025-08-15", "80%", "설계팀", "진행중", "프로토타입 제작"],
                    ["글로벌 진출", "2025-07-01", "2025-12-31", "30%", "영업팀", "진행중", "파트너사 발굴"],
                    ["정처기 자격증", "2025-06-01", "2025-12-31", "75%", "개인", "진행중", "필기 준비중"],
                    ["변리사 자격증", "2025-09-01", "2026-12-31", "0%", "개인", "계획", "2026년 목표"]
                ];
                
                // 빈 행 10개 추가
                for(let i = 0; i < 10; i++) {
                    projectData.push(["", "", "", "", "", "", ""]);
                }
                
                // 월별 목표 데이터
                const monthlyData = [
                    ["월", "목표", "달성률", "상세내용"],
                    ["2025-07", "뷰티 디바이스 프로토타입 완성", "60%", "CAD 설계 완료, 3D 프린팅 준비"],
                    ["2025-08", "AI 알고리즘 1차 완성", "0%", "피부 분석 기능 구현"],
                    ["2025-09", "정처기 필기 시험", "0%", "9월 시험 일정 확인 필요"],
                    ["2025-10", "포트폴리오 정리", "0%", "깃허브 프로젝트 업데이트"],
                    ["2025-11", "해외 파트너사 계약", "0%", "글로벌 진출 준비"],
                    ["2025-12", "연간 목표 점검", "0%", "2026년 계획 수립"]
                ];
                
                // 빈 행 10개 추가
                for(let i = 0; i < 10; i++) {
                    monthlyData.push(["", "", "", ""]);
                }
                
                // 자격증 관리 데이터
                const certData = [
                    ["자격증명", "취득일", "유효기간", "상태", "비고"],
                    ["피부미용사", "취득완료", "영구", "보유", "국가공인"],
                    ["컴퓨터응용가공산업기사", "취득완료", "영구", "보유", "국가기술자격"],
                    ["RevitMEP", "취득완료", "영구", "보유", "한국비아이엠"],
                    ["PM Primavera", "취득완료", "영구", "보유", "한국엔지니어링협회"],
                    ["MOS 2003 Expert", "취득완료", "영구", "보유", "Excel, PPT, Word"],
                    ["건강기능식품판매원", "취득완료", "영구", "보유", ""],
                    ["정보처리기사", "준비중", "영구", "목표", "2025년 취득 목표"],
                    ["변리사", "계획", "영구", "목표", "2026년 목표"]
                ];
                
                // 빈 행 10개 추가
                for(let i = 0; i < 10; i++) {
                    certData.push(["", "", "", "", ""]);
                }
                
                // CSV 변환
                const workLogCSV = arrayToCSV(workLogData);
                const projectCSV = arrayToCSV(projectData);
                const monthlyCSV = arrayToCSV(monthlyData);
                const certCSV = arrayToCSV(certData);
                
                // 텍스트 영역에 데이터 표시
                document.getElementById('workLogCSV').value = workLogCSV;
                document.getElementById('projectCSV').value = projectCSV;
                document.getElementById('monthlyCSV').value = monthlyCSV;
                document.getElementById('certCSV').value = certCSV;
                
                // 데이터 컨테이너 표시
                document.getElementById('csvDataContainer').style.display = 'block';
                
                // 버튼 텍스트 변경
                const btn = document.getElementById('showDataBtn');
                btn.textContent = '✅ CSV 데이터 생성 완료!';
                btn.style.background = 'linear-gradient(135deg, #28a745, #20c997)';
                
                console.log('✅ CSV 데이터 표시 완료!');
                
            } catch (error) {
                console.error('오류 발생:', error);
                alert('CSV 데이터 생성 중 오류가 발생했습니다: ' + error.message);
            }
        }
        
        // 클립보드 복사 함수
        function copyToClipboard(textareaId) {
            const textarea = document.getElementById(textareaId);
            textarea.select();
            textarea.setSelectionRange(0, 99999); // 모바일용
            
            try {
                document.execCommand('copy');
                
                // 복사 완료 메시지
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = '✅ 복사됨!';
                button.style.background = '#28a745';
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = '#007bff';
                }, 2000);
                
            } catch (err) {
                alert('복사에 실패했습니다. 직접 선택해서 복사해주세요.');
            }
        }
    </script>
</body>
</html>